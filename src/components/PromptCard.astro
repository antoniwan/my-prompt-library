---
import type { CollectionEntry } from "astro:content";
import TagPill from "./TagPill.astro";
import { promptDetail, promptsByDifficulty, promptsByAuthor } from "../utils/urls";
import { mutedLinkClasses } from "../utils/classes";

interface Props {
  entry: CollectionEntry<"prompts">;
  showTags?: boolean;
}

const { entry, showTags = true } = Astro.props;
---

<article
  class="group block rounded-lg border border-[var(--color-border)] border-l-4 border-l-[var(--color-border)] bg-[var(--color-surface)] p-5 sm:p-6 transition-colors hover:border-[var(--color-accent-border)] hover:border-l-[var(--color-accent)] hover:bg-[var(--color-surface-hover)]"
>
  <h2 class="text-base font-semibold leading-snug sm:text-lg">
    <a
      href={promptDetail(entry.id)}
      class="text-[var(--color-foreground)] no-underline hover:text-[var(--color-accent)] hover:underline focus-visible:text-[var(--color-accent)]"
    >
      {entry.data.title}
    </a>
  </h2>
  {
    entry.data.summary && (
      <p class="mt-2 text-sm sm:text-[0.95rem] text-[var(--color-muted)] line-clamp-3">
        {entry.data.summary}
      </p>
    )
  }

  <div
    class="mt-3 flex flex-wrap items-center gap-x-3 gap-y-1 text-[0.72rem] sm:text-xs text-[var(--color-muted)]"
  >
    <span>
      <span class="sr-only">Difficulty</span>
      <a href={promptsByDifficulty(entry.data.difficulty)} class={mutedLinkClasses}>
        {entry.data.difficulty}
      </a>
      <span aria-hidden="true"> Â· </span>
      <span class="sr-only">Author</span>
      <a href={promptsByAuthor(entry.data.author)} class={mutedLinkClasses}>
        {entry.data.author}
      </a>
    </span>
  </div>

  {
    showTags && entry.data.tags.length > 0 && (
      <div class="mt-5 sm:mt-3 flex flex-wrap gap-1.5">
        {entry.data.tags.map((tag) => (
          <TagPill tag={tag} />
        ))}
      </div>
    )
  }
</article>
