---
import Layout from "../layouts/Layout.astro";
import PageHeader from "../components/PageHeader.astro";
import PromptCard from "../components/PromptCard.astro";
import { getCollection } from "astro:content";

const allPrompts = await getCollection("prompts", ({ data }) => data.visibility === "public");
const recentPrompts = allPrompts
  .sort((a, b) => new Date(b.data.updated_at).getTime() - new Date(a.data.updated_at).getTime())
  .slice(0, 5);
---

<Layout
  title="My Prompt Library"
  description="A curated, Git-native library of structured prompts for sovereign AI workflows."
>
  <section class="mb-12">
    <h1 class="text-3xl font-bold tracking-tight text-[var(--color-foreground)] sm:text-4xl">
      My Prompt Library
    </h1>
    <p class="mt-3 max-w-xl text-lg text-[var(--color-muted)]">
      Plain-text prompts in Markdown, stored in Git. Copy, fork, and adapt them in your own tools. No lock-in.
    </p>
    <p class="mt-6">
      <a
        href="/prompts/"
        class="inline-flex items-center rounded-lg bg-[var(--color-accent)] px-4 py-2.5 text-sm font-medium text-white no-underline transition-opacity hover:opacity-90 focus-visible:opacity-90"
      >
        Browse prompts
      </a>
    </p>
  </section>

  {recentPrompts.length > 0 && (
    <section aria-labelledby="recent-heading">
      <h2 id="recent-heading" class="mb-4 text-lg font-semibold text-[var(--color-foreground)]">
        Recent prompts
      </h2>
      <ul class="list-none space-y-3 p-0">
        {recentPrompts.map((entry) => (
          <li>
            <PromptCard entry={entry} />
          </li>
        ))}
      </ul>
      <p class="mt-4">
        <a
          href="/prompts/"
          class="text-sm text-[var(--color-accent)] no-underline hover:underline focus-visible:underline"
        >
          View all prompts â†’
        </a>
      </p>
    </section>
  )}
</Layout>
